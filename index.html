<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>√Årvore Geneal√≥gica</title>
    <link rel="stylesheet" href="arvore_style.css">
</head>
<body>
   <div id="loadingMessage" style="display:none; position:fixed; top:0; left:0; width:100%; background:#fff3cd; color:#664d03; font-weight:bold; text-align:center; padding:1em; z-index:1000; border-bottom: 1px solid #ffc107;">Carregando...</div>
    <div class="container">
        <header>
            <h1>üå≥ √Årvore Geneal√≥gica</h1>
            <p>Um aplicativo para construir e gerenciar sua hist√≥ria familiar.</p>
        </header>

        <nav>
            <button id="btnNovaPessoa">Incluir Pessoa</button>
            <button id="btnGerenciar">Buscar Pessoas</button>
            <!-- O bot√£o "Percorrer √Årvore" foi removido daqui -->
        </nav>

        <!-- SE√á√ÉO 1: NOVA PESSOA -->
        <section id="secNovaPessoa">
            <h2>Incluindo Nova Pessoa</h2>
            <form id="pessoaForm">
                <label>Nome completo:</label>
                <input type="text" id="nome" required>

                <label>Sexo:</label>
                <select id="sexo">
                    <option value="">Selecione...</option>
                    <option value="M">Masculino</option>
                    <option value="F">Feminino</option>
                </select>

                <label>Nascimento:</label>
                <input type="text" id="nascimento" placeholder="DD/MM/AAAA">

                <label>Falecimento (opcional):</label>
                <input type="text" id="falecimento">

                <label>Profiss√£o (opcional):</label>
                <input type="text" id="profissao">

                <label>Cidade/Pa√≠s principal (opcional):</label>
                <input type="text" id="cidade_pais">

                <button type="submit">Salvar Registro</button>
            </form>
            <div id="registroAtualContainer">Nenhum registro criado nesta sess√£o.</div>
        </section>

        <!-- SE√á√ÉO 2: GERENCIAR REGISTROS (COM REATORA√á√ÉO) -->
        <section id="secGerenciar">
            <h2>Registros</h2>
            
            <label>Filtrar por Nome ou Sobrenome:</label>
            <input type="text" id="filtroNome">

            <!-- NOVOS BOT√ïES DE A√á√ÉO GLOBAIS -->
            <div id="botoesAcaoGlobais">
                <button id="btnEditarSelecionado">‚úèÔ∏è Editar Selecionado</button>
                <button id="btnVisualizarSelecionado">üå≥ Visualizar √Årvore</button>
            </div>

            <div id="registrosLista"></div> <!-- A lista ser√° populada com radio buttons via JS -->

            <div id="registroAtualContainer2" style="display:none; margin-top: 30px; padding-top: 30px; border-top: 1px solid #ddd;">
                <h3>Editar Registro</h3>
                <form id="editarForm" style="display:none;">
                    <!-- Campos de edi√ß√£o permanecem os mesmos -->
                    <label>ID:</label>
                    <input type="text" id="edit-id" readonly>
                    <label>Nome completo:</label>
                    <input type="text" id="edit-nome">
                    <label>Sexo:</label>
                    <select id="edit-sexo">
                        <option value="">Selecione...</option>
                        <option value="M">Masculino</option>
                        <option value="F">Feminino</option>
                    </select>
                    <label>Nascimento:</label>
                    <input type="text" id="edit-nascimento">
                    <label>Falecimento:</label>
                    <input type="text" id="edit-falecimento">
                    <label>Profiss√£o:</label>
                    <input type="text" id="edit-profissao">
                    <label>Cidade/Pa√≠s principal:</label>
                    <input type="text" id="edit-cidade_pais">
                    <button type="button" id="btnSalvarEdicao">Salvar Altera√ß√µes</button>
                    <button type="button" id="btnExcluirRegistro">Excluir Registro</button>
                    <button type="button" id="btnCancelarEditar">Cancelar</button>
                </form>

                <div id="vinculosSection" style="margin-top: 30px; padding-top: 30px; border-top: 1px solid #ddd;">
                    <h3>V√≠nculos Atuais:</h3>
                    <div id="vinculosLista"></div>
                    <div class="vinculo-container">
                        <h4 id="labelNomePessoaEditada" class="vinculo-pessoa-nome"></h4>
                        <select id="selectRelacao">
                            <option value="pai">√© pai/m√£e de...</option>
                            <option value="filho">√© filho(a) de...</option>
                            <option value="conjuge">√© (ou foi) c√¥njuge de...</option>
                        </select>
                        <select id="selectPessoaVinculo">
                            <option value="">Selecione uma pessoa...</option>
                        </select>
                        <button type="button" id="btnAdicionarVinculo">Adicionar V√≠nculo</button>
                    </div>
                </div>
            </div>
        </section>

<!-- SE√á√ÉO 3: VISUALIZAR √ÅRVORE -->
<section id="secVisualizarArvore">
    <h2 style="text-align: center;">√Årvore Geneal√≥gica - Visualiza√ß√£o</h2>
    
<div class="form-group">
    <label for="inputPessoaCentral">Buscar e selecionar a pessoa central da √°rvore:</label>
    <input type="text" id="inputPessoaCentral" list="listaPessoas" class="form-control" placeholder="Digite um nome para buscar...">
    <datalist id="listaPessoas">
        <!-- As op√ß√µes ser√£o preenchidas pelo JavaScript -->
    </datalist>
</div>

    <!-- NOVO BOT√ÉO DE EDITAR -->
    <button id="btnEditarNaArvore" style="display: none; margin-top: 10px; background-color: #ee9b00;">‚úèÔ∏è Editar Pessoa Central</button>

    <div id="arvoreContainer"></div>
</section>


        <!-- RODAP√â: BOT√ïES DE SINCRONIZA√á√ÉO E EXPORTA√á√ÉO -->
        <footer>
            <button id="btnExportarJSON">Salvar LOCAL</button>
            <button id="btnImportarJSON">Carregar LOCAL</button>
            <button id="btnSalvarSupabase">‚òÅÔ∏è Salvar na Nuvem</button>
            <button id="btnCarregarSupabase">‚¨áÔ∏è Carregar da Nuvem</button>
            <button id="btnDicas" title="Ver Dicas de Uso">üí°</button> <!-- NOVO BOT√ÉO DE DICAS -->
            <input type="file" id="inputImportJSON" accept=".json,.txt" style="display: none;">
        </footer>
    </div>

<!-- NOVO CONTE√öDO DO MODAL DE DICAS -->
<div id="dicasModal" class="modal">
    <div class="modal-content">
        <span class="close-button">&times;</span>
        <h2>Instru√ß√µes e Dicas</h2>
        <p id="dicaTexto">Carregando dicas...</p>
        <div class="dicas-nav">
            <button id="btnDicaAnterior" title="Dica Anterior">-</button>
            <span id="dicaContador">0 / 0</span>
            <button id="btnDicaProxima" title="Pr√≥xima Dica">+</button>
        </div>
    </div>
</div>


    <!-- SCRIPTS -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="arvore_script.js"></script>
</body>
</html>

