<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ãrvore GenealÃ³gica</title>
    <link rel="stylesheet" href="arvore_style.css">
</head>
<body>
   <div id="loadingMessage" style="display:none; position:fixed; top:0; left:0; width:100%; background:#fff3cd; color:#664d03; font-weight:bold; text-align:center; padding:1em; z-index:1000; border-bottom: 1px solid #ffc107;">Carregando...</div>
    <div class="container">
        <header>
            <h1>ğŸŒ³ Ãrvore GenealÃ³gica</h1>
            <p>Para construir e lembrar a histÃ³ria da famÃ­lia</p>
        </header>
        <nav>
            <button id="btnRefugio" style="display: none;">ğŸ  InÃ­cio</button>
        </nav>
        
<section id="secAbertura">
            <img src="arvore_familia.png" alt="Ãrvore GenealÃ³gica da FamÃ­lia" class="imagem-abertura">
            
            <!-- NOVO: Container que permite o alinhamento horizontal (FLEX) -->
            <div id="hub-botoes"> 
                <button id="btnGerenciarHub" class="hub-button">ğŸ“œğŸ” - Lista de Pessoas</button>
                <button id="btnNovaPessoaHub" class="hub-button">â• Incluir Nova Pessoa</button>
                <button id="btnVerAniversarios" class="hub-button">ğŸ‚ Aniversariantes do MÃªsğŸˆğŸˆ</button>
            </div>
        </section>
       
        <section id="secNovaPessoa">
            <h2>Incluindo Nova Pessoa</h2>
            <form id="pessoaForm">
                <label>Nome completo:</label>
                <input type="text" id="nome" required>
                <label>Sexo:</label>
                <select id="sexo">
                    <option value="">Selecione...</option>
                    <option value="M">Masculino</option>
                    <option value="F">Feminino</option>
                </select>
                <label>Nascimento:</label>
                <input type="text" id="nascimento" placeholder="DD/MM/AAAA">
                <label>Falecimento (opcional):</label>
                <input type="text" id="falecimento">
                <label>ProfissÃ£o (opcional):</label>
                <input type="text" id="profissao">
                <label>Cidade/PaÃ­s principal (opcional):</label>
                <input type="text" id="cidade_pais">
                <button type="submit">Salvar Registro</button>
                <button type="button" id="btnCancelarInclusao">Cancelar</button>
            </form>
            <div id="registroAtualContainer">Nenhum registro criado nesta sessÃ£o.</div>
        </section>
        
<section id="secGerenciar">
            <h2>Registros</h2>
            
            <!-- NOVO CONTAINER: Agrupa os filtros em uma coluna (COM A ESTRUTURA CORRETA) -->
            <div id="filtrosContainer">
                
                <div class="filtro-grupo">
                    <label for="filtroNome">Filtrar por Nome ou Sobrenome:</label>
                    <input type="text" id="filtroNome">
                </div>
                
                <div class="filtro-grupo">
                    <label for="filtroCidadePais">Filtrar por Cidade, PaÃ­s ou Local:</label>
                    <input type="text" id="filtroCidadePais">
                </div>
                
            </div>
            <!-- FIM DO CONTAINER DE FILTROS -->
            
            <div id="botoesAcaoGlobais">
                <button id="btnVisualizarSelecionado">ğŸ‘¨â€ğŸ‘©â€ğŸ‘¦â€ğŸ‘¦ Visualizar FamÃ­lia de:</button>
            </div>
            <div id="registrosLista"></div>
        </section>
        
        <!-- O bloco secAniversariantes deve vir DEPOIS de secGerenciar -->
        <section id="secAniversariantes" style="display:none;">
            <h2>ğŸ‚ Aniversariantes do MÃªs: <span id="mesAtual"></span></h2>
            <div id="aniversariantesLista">
                <!-- Lista de aniversariantes serÃ¡ gerada aqui -->
                <p>Carregando aniversariantes...</p>
            </div>
        </section>

        <section id="secVisualizarArvore">
            <h2 style="text-align: center;">Ãrvore GenealÃ³gica - VisualizaÃ§Ã£o</h2>
            <div class="form-group">
                <label for="inputPessoaCentral">Buscar e selecionar a pessoa central da Ã¡rvore:</label>
                <input type="text" id="inputPessoaCentral" list="listaPessoas" class="form-control" placeholder="Digite um nome para buscar...">
                <datalist id="listaPessoas">
                    </datalist>
            </div>
            <button id="btnEditarNaArvore" style="display: none; margin-top: 10px; background-color: #ee9b00;">âœï¸ Editar Pessoa Central</button>
            <div id="arvoreContainer"></div>
        </section>
        
        <section id="secEditarPessoa">
            <h2>Editar Registro</h2>
            <form id="editarForm">
               <!--  <label>ID:</label>  -->
               <!-- <input type="text" id="edit-id" readonly>  -->
                <label>Nome completo:</label>
                <input type="text" id="edit-nome">
                <label>Sexo:</label>
                <select id="edit-sexo">
                    <option value="">Selecione...</option>
                    <option value="M">Masculino</option>
                    <option value="F">Feminino</option>
                </select>
                <label>Nascimento:</label>
                <input type="text" id="edit-nascimento">
                <label>Falecimento:</label>
                <input type="text" id="edit-falecimento">
                <label>ProfissÃ£o:</label>
                <input type="text" id="edit-profissao">
                <label>Cidade/PaÃ­s principal:</label>
                <input type="text" id="edit-cidade_pais">
                <button type="button" id="btnSalvarEdicao">Salvar AlteraÃ§Ãµes</button>
                <button type="button" id="btnExcluirRegistro">Excluir Registro</button>
                <button type="button" id="btnCancelarEditar">Cancelar</button>
            </form>
            <div id="vinculosSection" style="margin-top: 30px; padding-top: 30px; border-top: 1px solid #ddd;">
                <h3 id="labelNomePessoaEditada" class="vinculo-pessoa-nome">Editando Pessoa: [Nome]</h3>
                <h3>VÃ­nculos Atuais:</h3>
                <div id="vinculosLista"></div>

<div class="vinculo-creator">
    <h3>Novo Vinculo:</h3>
  <dir id="escolha-vÃ­nculo"></div>
    <strong id="nomePessoaPrincipalVinculo" class="vinculo-pessoa-nome"></strong>
    <select id="selectRelacao">
        <option value="filho">Ã© filho(a) de</option>
        <option value="pai">Ã© pai/mÃ£e de</option>
        <option value="conjuge">Ã© cÃ´njuge de</option>
    </select>
    <select id="selectPessoaVinculo">
        <option value="">Selecione uma pessoa...</option>
    </select>
    <button type="button" id="btnAdicionarVinculo">Salvar VÃ­nculo</button>
</div>

            </div>
        </section>
        
        <footer>
            <button id="btnExportarJSON">SALVAR DADOS</button>
            <button id="btnImportarJSON">CARREGAR</button>
            <button id="btnSalvarSupabase" style="display: none;">â˜ï¸ Salvar na Nuvem</button>
            <button id="btnCarregarSupabase" style="display: none;">â¬‡ï¸ Carregar da Nuvem</button>
            <button id="btnDicas" title="Dicas de Uso">ğŸ’¡</button>
            <input type="file" id="inputImportJSON" accept=".json,.txt" style="display: none;">
        </footer>
    </div>
<div id="dicasModal" class="modal">
    <div class="modal-content">
        <span class="close-button">&times;</span>
        <h3>InstruÃ§Ãµes e Dicas</h3>
        <div class="dicas-nav">
            <button id="btnDicaAnterior" title="Dica anterior">&#9664;</button>
            <span id="dicaContador">0 / 0</span>
            <button id="btnDicaProxima" title="PrÃ³xima dica">&#9654;</button>
        </div>
        <div class="dica-content-wrapper">
            <p id="dicaTexto">Carregando dicas...</p>
        </div>
    </div>
</div>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="arvore_script.js"></script>
</body>
</html>